<!-- Main Admin Panel -->
<div id="lorebook-protection-panel" class="lorebook-protection-panel">
    <!-- Collapse/Expand Toggle Button -->
    <button class="lorebook-toggle-btn" id="lorebook-toggle-panel" title="Toggle Lorebook Protection Panel">
        <i class="fa-solid fa-chevron-right"></i>
        <span class="toggle-icon">üîê</span>
    </button>

    <!-- Main Panel Content -->
    <div class="lorebook-panel-container">
        <!-- Panel Header -->
        <div class="lorebook-panel-header">
            <div class="header-content">
                <h3>
                    <i class="fa-solid fa-shield-halved"></i>
                    {{serverName}} Lorebook Admin
                </h3>
                <button id="lorebook-close-panel" class="close-btn" title="Close Panel">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
        </div>

        <!-- Panel Body -->
        <div class="lorebook-panel-body">
            <!-- Quick Actions -->
            <div class="lorebook-section">
                <h4>Quick Actions</h4>
                <div class="action-buttons">
                    <button id="lorebook-refresh-list" class="btn btn-primary">
                        <i class="fa-solid fa-sync"></i> Refresh List
                    </button>
                    <button id="lorebook-export-data" class="btn btn-secondary">
                        <i class="fa-solid fa-download"></i> Export Data
                    </button>
                    <button id="lorebook-import-data" class="btn btn-secondary">
                        <i class="fa-solid fa-upload"></i> Import Data
                    </button>
                    <button id="lorebook-reset-settings" class="btn btn-danger">
                        <i class="fa-solid fa-trash"></i> Reset All
                    </button>
                </div>
            </div>

            <!-- Permission Management -->
            <div class="lorebook-section">
                <h4>Permission Management</h4>
                <div class="permission-form">
                    <div class="form-row">
                        <label for="lorebook-character-select">Character:</label>
                        <select id="lorebook-character-select">
                            <option value="">Select character...</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <label for="lorebook-user-input">User ID:</label>
                        <input type="text" id="lorebook-user-input" placeholder="Enter user ID...">
                    </div>
                    <div class="form-row">
                        <button id="lorebook-grant-permission" class="btn btn-success">
                            <i class="fa-solid fa-plus"></i> Grant Access
                        </button>
                        <button id="lorebook-revoke-permission" class="btn btn-warning">
                            <i class="fa-solid fa-minus"></i> Revoke Access
                        </button>
                    </div>
                </div>
            </div>

            <!-- Character List -->
            <div class="lorebook-section">
                <div class="section-header">
                    <h4>Character Permissions</h4>
                    <div class="filter-controls">
                        <input type="text" id="lorebook-search-characters" placeholder="Search characters..." class="search-input">
                        <select id="lorebook-filter-permissions" class="filter-select">
                            <option value="all">All Characters</option>
                            <option value="has-permissions">Has Permissions</option>
                            <option value="no-permissions">No Permissions</option>
                        </select>
                    </div>
                </div>
                <div class="character-list" id="lorebook-permissions-list">
                    <div class="lorebook-empty-state">Loading characters...</div>
                </div>
            </div>

            <!-- Access Logs -->
            <div class="lorebook-section">
                <div class="section-header">
                    <h4>Access Logs</h4>
                    <button id="lorebook-clear-logs" class="btn btn-small btn-danger">
                        <i class="fa-solid fa-trash"></i> Clear Logs
                    </button>
                </div>
                <div class="logs-container" id="lorebook-access-logs">
                    <div class="lorebook-empty-state">No access logs</div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Permission Management Modal -->
<div id="lorebook-protection-modal" class="lorebook-modal hidden">
    <div class="modal-backdrop" onclick="hidePermissionModal()"></div>
    <div class="modal-content">
        <div class="modal-header">
            <h3>
                <i class="fa-solid fa-shield-halved"></i>
                {{serverName}} Lorebook Admin
            </h3>
            <button class="modal-close" onclick="hidePermissionModal()">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>
        <div class="modal-body">
            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="tab-btn active" data-tab="permissions">Permissions</button>
                <button class="tab-btn" data-tab="logs">Access Logs</button>
                <button class="tab-btn" data-tab="settings">Settings</button>
            </div>

            <!-- Permissions Tab -->
            <div class="tab-content active" id="permissions-tab">
                <div class="permission-form">
                    <div class="form-group">
                        <label for="modal-character-select">Character:</label>
                        <select id="modal-character-select">
                            <option value="">Select character...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="modal-user-input">User ID:</label>
                        <input type="text" id="modal-user-input" placeholder="Enter user ID...">
                    </div>
                    <div class="form-actions">
                        <button class="btn btn-success" onclick="grantPermission()">
                            <i class="fa-solid fa-plus"></i> Grant Access
                        </button>
                        <button class="btn btn-warning" onclick="revokePermission()">
                            <i class="fa-solid fa-minus"></i> Revoke Access
                        </button>
                    </div>
                </div>
                <div class="permissions-list" id="modal-permissions-list">
                    <div class="lorebook-empty-state">Loading permissions...</div>
                </div>
            </div>

            <!-- Logs Tab -->
            <div class="tab-content" id="logs-tab">
                <div class="logs-controls">
                    <button class="btn btn-small" onclick="updateLogDisplay()">
                        <i class="fa-solid fa-sync"></i> Refresh
                    </button>
                    <button class="btn btn-small btn-danger" onclick="clearAccessLogs()">
                        <i class="fa-solid fa-trash"></i> Clear All
                    </button>
                </div>
                <div class="logs-container" id="modal-access-logs">
                    <div class="lorebook-empty-state">No access logs</div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-content" id="settings-tab">
                <div class="settings-form">
                    <div class="form-group">
                        <label for="modal-security-level">Security Level:</label>
                        <select id="modal-security-level">
                            <option value="low">Low - Basic protection</option>
                            <option value="medium">Medium - Standard protection</option>
                            <option value="high">High - Maximum security</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="modal-notifications">
                            <span>Enable notifications</span>
                        </label>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="modal-auto-cleanup">
                            <span>Auto-cleanup old logs</span>
                        </label>
                    </div>
                    <div class="form-actions">
                        <button class="btn btn-primary" onclick="saveModalSettings()">
                            <i class="fa-solid fa-save"></i> Save Settings
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>